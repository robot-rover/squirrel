---
source: squirrel_lang/src/parser/mod.rs
expression: Parser test for edge_cases/lost_env.nut
---
keyword_span:
  start: 0
  end: 0
arg_span:
  start: 0
  end: 0
num_args: 0
default_expr: []
local_names:
  - - vargv
    - 0
num_locals: 1
upvalues: []
is_varargs: true
body:
  data:
    Block:
      - data:
          Expr:
            data:
              Assign:
                target:
                  Ident:
                    - env
                    - start: 0
                      end: 3
                value:
                  data:
                    TableDecl:
                      - - data:
                            Literal:
                              String: field
                          span:
                            start: 13
                            end: 18
                        - data:
                            Literal:
                              String: I am ENV
                          span:
                            start: 21
                            end: 31
                  span:
                    start: 7
                    end: 33
                kind: NewSlot
                op_span:
                  start: 4
                  end: 6
            span:
              start: 0
              end: 33
        span:
          start: 0
          end: 33
      - data:
          Expr:
            data:
              Assign:
                target:
                  Ident:
                    - array_tostring
                    - start: 44
                      end: 58
                value:
                  data:
                    FunctionDef:
                      keyword_span:
                        start: 35
                        end: 43
                      arg_span:
                        start: 58
                        end: 63
                      num_args: 1
                      default_expr: []
                      local_names:
                        - - arr
                          - 0
                        - - str
                          - 1
                        - - idx
                          - 2
                        - - val
                          - 3
                      num_locals: 4
                      upvalues: []
                      is_varargs: false
                      body:
                        data:
                          Block:
                            - data:
                                Expr:
                                  data:
                                    Assign:
                                      target:
                                        Local:
                                          - 1
                                          - start: 76
                                            end: 79
                                      value:
                                        data:
                                          Literal:
                                            String: "["
                                        span:
                                          start: 82
                                          end: 85
                                      kind: Normal
                                      op_span:
                                        start: 80
                                        end: 81
                                  span:
                                    start: 76
                                    end: 85
                              span:
                                start: 76
                                end: 85
                            - data:
                                Foreach:
                                  index_idx: 2
                                  value_idx: 3
                                  iterable:
                                    data:
                                      Local:
                                        - 0
                                        - start: 111
                                          end: 114
                                    span:
                                      start: 111
                                      end: 114
                                  body:
                                    data:
                                      Block:
                                        - data:
                                            Expr:
                                              data:
                                                Assign:
                                                  target:
                                                    Local:
                                                      - 1
                                                      - start: 126
                                                        end: 129
                                                  value:
                                                    data:
                                                      BinaryOp:
                                                        op: Add
                                                        op_span:
                                                          start: 136
                                                          end: 137
                                                        lhs:
                                                          data:
                                                            Local:
                                                              - 1
                                                              - start: 132
                                                                end: 135
                                                          span:
                                                            start: 132
                                                            end: 135
                                                        rhs:
                                                          data:
                                                            Local:
                                                              - 3
                                                              - start: 138
                                                                end: 141
                                                          span:
                                                            start: 138
                                                            end: 141
                                                    span:
                                                      start: 132
                                                      end: 141
                                                  kind: Normal
                                                  op_span:
                                                    start: 130
                                                    end: 131
                                              span:
                                                start: 126
                                                end: 141
                                          span:
                                            start: 126
                                            end: 141
                                        - data:
                                            IfElse:
                                              - data:
                                                  BinaryOp:
                                                    op: Less
                                                    op_span:
                                                      start: 158
                                                      end: 159
                                                    lhs:
                                                      data:
                                                        Local:
                                                          - 2
                                                          - start: 154
                                                            end: 157
                                                      span:
                                                        start: 154
                                                        end: 157
                                                    rhs:
                                                      data:
                                                        BinaryOp:
                                                          op: Sub
                                                          op_span:
                                                            start: 170
                                                            end: 171
                                                          lhs:
                                                            data:
                                                              FunctionCall:
                                                                func:
                                                                  FieldAccess:
                                                                    - data:
                                                                        Local:
                                                                          - 0
                                                                          - start: 160
                                                                            end: 163
                                                                      span:
                                                                        start: 160
                                                                        end: 163
                                                                    - - len
                                                                      - start: 164
                                                                        end: 167
                                                                args: []
                                                            span:
                                                              start: 167
                                                              end: 169
                                                          rhs:
                                                            data:
                                                              Literal:
                                                                Integer: 1
                                                            span:
                                                              start: 172
                                                              end: 173
                                                      span:
                                                        start: 167
                                                        end: 173
                                                span:
                                                  start: 154
                                                  end: 173
                                              - data:
                                                  Block:
                                                    - data:
                                                        Expr:
                                                          data:
                                                            Assign:
                                                              target:
                                                                Local:
                                                                  - 1
                                                                  - start: 189
                                                                    end: 192
                                                              value:
                                                                data:
                                                                  BinaryOp:
                                                                    op: Add
                                                                    op_span:
                                                                      start: 199
                                                                      end: 200
                                                                    lhs:
                                                                      data:
                                                                        Local:
                                                                          - 1
                                                                          - start: 195
                                                                            end: 198
                                                                      span:
                                                                        start: 195
                                                                        end: 198
                                                                    rhs:
                                                                      data:
                                                                        Literal:
                                                                          String: ", "
                                                                      span:
                                                                        start: 201
                                                                        end: 205
                                                                span:
                                                                  start: 195
                                                                  end: 205
                                                              kind: Normal
                                                              op_span:
                                                                start: 193
                                                                end: 194
                                                          span:
                                                            start: 189
                                                            end: 205
                                                      span:
                                                        start: 189
                                                        end: 205
                                                span:
                                                  start: 0
                                                  end: 215
                                              - data: Empty
                                                span:
                                                  start: 0
                                                  end: 0
                                          span:
                                            start: 0
                                            end: 215
                                    span:
                                      start: 0
                                      end: 221
                              span:
                                start: 0
                                end: 221
                            - data:
                                Return:
                                  data:
                                    BinaryOp:
                                      op: Add
                                      op_span:
                                        start: 237
                                        end: 238
                                      lhs:
                                        data:
                                          Local:
                                            - 1
                                            - start: 233
                                              end: 236
                                        span:
                                          start: 233
                                          end: 236
                                      rhs:
                                        data:
                                          Literal:
                                            String: "]"
                                        span:
                                          start: 239
                                          end: 242
                                  span:
                                    start: 233
                                    end: 242
                              span:
                                start: 226
                                end: 242
                        span:
                          start: 0
                          end: 244
                  span:
                    start: 0
                    end: 244
                kind: NewSlot
                op_span:
                  start: 35
                  end: 43
            span:
              start: 0
              end: 244
        span:
          start: 0
          end: 244
      - data:
          Expr:
            data:
              Assign:
                target:
                  Ident:
                    - going_to_lose
                    - start: 255
                      end: 268
                value:
                  data:
                    FunctionDef:
                      keyword_span:
                        start: 246
                        end: 254
                      arg_span:
                        start: 268
                        end: 270
                      num_args: 0
                      default_expr: []
                      local_names: []
                      num_locals: 0
                      upvalues: []
                      is_varargs: false
                      body:
                        data:
                          Block:
                            - data:
                                Expr:
                                  data:
                                    FunctionCall:
                                      func:
                                        FieldAccess:
                                          - data: Globals
                                            span:
                                              start: 277
                                              end: 279
                                          - - print
                                            - start: 279
                                              end: 284
                                      args:
                                        - data:
                                            BinaryOp:
                                              op: Add
                                              op_span:
                                                start: 290
                                                end: 291
                                              lhs:
                                                data: This
                                                span:
                                                  start: 285
                                                  end: 289
                                              rhs:
                                                data:
                                                  Literal:
                                                    String: "\n"
                                                span:
                                                  start: 292
                                                  end: 296
                                          span:
                                            start: 285
                                            end: 296
                                  span:
                                    start: 284
                                    end: 297
                              span:
                                start: 284
                                end: 297
                            - data:
                                IfElse:
                                  - data:
                                      BinaryOp:
                                        op: Eq
                                        op_span:
                                          start: 311
                                          end: 313
                                        lhs:
                                          data: This
                                          span:
                                            start: 306
                                            end: 310
                                        rhs:
                                          data:
                                            Literal: "Null"
                                          span:
                                            start: 314
                                            end: 318
                                    span:
                                      start: 306
                                      end: 318
                                  - data:
                                      Block:
                                        - data:
                                            Expr:
                                              data:
                                                FunctionCall:
                                                  func:
                                                    FieldAccess:
                                                      - data: Globals
                                                        span:
                                                          start: 330
                                                          end: 332
                                                      - - print
                                                        - start: 332
                                                          end: 337
                                                  args:
                                                    - data:
                                                        Literal:
                                                          String: "I am null\n"
                                                      span:
                                                        start: 338
                                                        end: 351
                                              span:
                                                start: 337
                                                end: 352
                                          span:
                                            start: 337
                                            end: 352
                                    span:
                                      start: 0
                                      end: 358
                                  - data:
                                      Block:
                                        - data:
                                            Expr:
                                              data:
                                                FunctionCall:
                                                  func:
                                                    FieldAccess:
                                                      - data: Globals
                                                        span:
                                                          start: 374
                                                          end: 376
                                                      - - print
                                                        - start: 376
                                                          end: 381
                                                  args:
                                                    - data:
                                                        Literal:
                                                          String: "I am not null\n"
                                                      span:
                                                        start: 382
                                                        end: 399
                                              span:
                                                start: 381
                                                end: 400
                                          span:
                                            start: 381
                                            end: 400
                                        - data:
                                            Expr:
                                              data:
                                                Assign:
                                                  target:
                                                    FieldAccess:
                                                      - data: This
                                                        span:
                                                          start: 409
                                                          end: 413
                                                      - - field
                                                        - start: 414
                                                          end: 419
                                                  value:
                                                    data:
                                                      Literal:
                                                        String: I am new
                                                    span:
                                                      start: 423
                                                      end: 433
                                                  kind: NewSlot
                                                  op_span:
                                                    start: 420
                                                    end: 422
                                              span:
                                                start: 409
                                                end: 433
                                          span:
                                            start: 409
                                            end: 433
                                    span:
                                      start: 0
                                      end: 439
                              span:
                                start: 0
                                end: 439
                            - data:
                                Return:
                                  data: This
                                  span:
                                    start: 451
                                    end: 455
                              span:
                                start: 444
                                end: 455
                        span:
                          start: 0
                          end: 457
                  span:
                    start: 0
                    end: 457
                kind: NewSlot
                op_span:
                  start: 246
                  end: 254
            span:
              start: 0
              end: 457
        span:
          start: 0
          end: 457
      - data:
          Expr:
            data:
              RawCall:
                func:
                  data:
                    Ident: going_to_lose
                  span:
                    start: 467
                    end: 480
                this:
                  data:
                    Ident: env
                  span:
                    start: 482
                    end: 485
                parameters: []
            span:
              start: 459
              end: 486
        span:
          start: 459
          end: 486
      - data:
          Expr:
            data:
              FunctionCall:
                func:
                  FieldAccess:
                    - data: Globals
                      span:
                        start: 487
                        end: 489
                    - - print
                      - start: 489
                        end: 494
                args:
                  - data:
                      BinaryOp:
                        op: Add
                        op_span:
                          start: 522
                          end: 523
                        lhs:
                          data:
                            FunctionCall:
                              func:
                                Expr:
                                  data:
                                    Ident: array_tostring
                                  span:
                                    start: 495
                                    end: 509
                              args:
                                - data:
                                    FunctionCall:
                                      func:
                                        FieldAccess:
                                          - data:
                                              Ident: env
                                            span:
                                              start: 510
                                              end: 513
                                          - - keys
                                            - start: 514
                                              end: 518
                                      args: []
                                  span:
                                    start: 518
                                    end: 520
                          span:
                            start: 509
                            end: 521
                        rhs:
                          data:
                            Literal:
                              String: "\n"
                          span:
                            start: 524
                            end: 528
                    span:
                      start: 509
                      end: 528
            span:
              start: 494
              end: 529
        span:
          start: 494
          end: 529
      - data:
          Expr:
            data:
              RawCall:
                func:
                  data:
                    Ident: going_to_lose
                  span:
                    start: 538
                    end: 551
                this:
                  data:
                    Literal: "Null"
                  span:
                    start: 553
                    end: 557
                parameters: []
            span:
              start: 530
              end: 558
        span:
          start: 530
          end: 558
  span:
    start: 0
    end: 558
